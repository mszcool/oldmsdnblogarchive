<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>VSTO 2005 - &quot;Inheritance&quot; to implement &quot;Template-based&quot; Solutions??</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/mszCool [mario]' target='_blank'>mszCool [mario]</a>
<time>    3/27/2006 11:48:00 AM</time>
<hr>
<div id='content'><P><FONT face=Verdana size=2>Another question I got from the VSTO 2005 event in Denmark in February was a really interesting one. In short words the customer wants to create a central document template with a VSTO 2005 customization with the primary logic. Every outpost or department then should have the possibility to create a template that inherits functionality and basic layout from the central template. The primary reason for having this type of "inherited" templates is that the departments and outposts want to add some additional standard texts and logos in dedicated sections of the document.</FONT></P>
<P><STRONG><FONT face=Verdana size=2>The first view: man, it's not simple...</FONT></STRONG></P>
<P><FONT face=Verdana size=2>Well, unfortunately you cannot create templates that inherit behavior and customization assemblies from other templates with the current version or the next version of Office. But for the scenario above I think there is another nice way for solving the problem.</FONT></P>
<P><STRONG><FONT face=Verdana size=2>Take a closer look: hey, it's really simple;)</FONT></STRONG></P>
<P><FONT face=Verdana size=2>Actually you can create a template that has all the boilerplate sections, texts and images in it as well as the association with the customization assembly. For inserting "customized" logos, text portions or sections, your customization assembly could provide functionality, that reads this information from other word documents and copies them into this document. Of course if you insert version information about the artifacts your customization assembly has added to the document, you even can update these parts if they are out of date.</FONT></P>
<P><FONT face=Verdana size=2>The parts inserted by your customization assembly might come from one of the following locations:</FONT></P>
<UL>
<LI><FONT face=Verdana size=2>Another Word document stored on the file system</FONT> 
<LI><FONT face=Verdana size=2>A Word document stored in a database</FONT> 
<LI><FONT face=Verdana size=2>Word documents retrieved from web services</FONT> 
<LI><FONT face=Verdana size=2>any other text file retrieved from any other data source.</FONT></LI></UL>
<P><FONT face=Verdana size=2>Actually as you are using .NET for creating the customization assembly, you can get the information from anywhere you want. Your customization assembly just needs to get the data to be inserted into your document and use Word's <FONT face="Courier New" size=3><STRONG>InsertFile()</STRONG></FONT> method.</FONT></P>
<P><FONT face=Verdana size=2><STRONG>A sample solution - attached to this post</STRONG></FONT></P>
<P><FONT face=Verdana size=2>I have attached a simple example that demonstrates a possible way for achieving this result. This is a word document that has a VSTO 2005&nbsp;customization attached. The document defines the overall structure of the content and the portions of text and paragraphs that need to be in each and every document. It also defines a number of place-holders through bookmarks (of course you can do the same thing by attaching an XML schema, I just used bookmarks for simplicity).</FONT></P>
<P><FONT face=Verdana size=2>The VSTO customization assembly comes with a control that gives you the possibility for selecting a template from a list and applying this template to your document. This actually takes information from a number of other Word documents stored in a sub directory of the solution - but remember, you can also retrieve them from a database or a web service, InsertFile() just needs you to save them temporarily on your file system (shouldn't be a problem;)). Every Word document in each of the templates sub directory is a part that will be inserted to it's designated section of the document containing the place-holders and the VSTO customization. </FONT></P>
<P><FONT face=Verdana size=2>The Word documents in the template sub directory are NOT attached to a customization, nor do they have any functionality. These documents contain just text, images or other content without functionality.</FONT></P><IMG src="/mszcool/attachment/562071.ashx"> 
<P><FONT face=Verdana size=2>It then uses the <FONT face="Courier New"><STRONG>InsertFile()</STRONG></FONT> method of word to insert the different pre-defined text and image parts from the template documents into the primary document as follows:</FONT></P><FONT face=Verdana size=2><FONT color=#0000ff size=4>
<P><FONT size=2>object</FONT></FONT> start, end;<BR><FONT color=#0000ff>object</FONT> missing = System.<FONT color=#008080>Type</FONT>.Missing;<BR><FONT color=#0000ff>string</FONT> TemplatePath = TemplatesList.SelectedItems[0].Tag <FONT color=#0000ff>as</FONT> <FONT color=#0000ff>string</FONT>;</P><FONT color=#008000>
<P>// Insert the header templates<BR></FONT>start = <FONT color=#008080>Globals</FONT>.ThisDocument.HeaderBookmark.Start + 1;<BR>end = <FONT color=#008080>Globals</FONT>.ThisDocument.HeaderBookmark.End - 1;<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Range(<FONT color=#0000ff>ref</FONT> start, <FONT color=#0000ff>ref</FONT> end).Select();<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Application.Selection.InsertFile(<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string</FONT>.Format(<FONT color=#800000>"{0}\\{1}\\Header.doc"</FONT>,<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>MySettings.TemplateDirectory,<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>TemplatePath<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>),<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing<BR>);</P><FONT size=4>
<P><FONT size=2><FONT color=#008000>// Insert the footer templates<BR></FONT>start = <FONT color=#008080>Globals</FONT>.ThisDocument.CompanyFooterBookmark.Start + 1;<BR>end = <FONT color=#008080>Globals</FONT>.ThisDocument.CompanyFooterBookmark.End -<BR>1;<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Range(<FONT color=#0000ff>ref</FONT> start, <FONT color=#0000ff>ref</FONT> end).Select();<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Application.Selection.InsertFile(<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string</FONT>.Format(<FONT color=#800000>"{0}\\{1}\\Footer.doc"</FONT>,<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>MySettings.TemplateDirectory,<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>TemplatePath<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>),<BR><FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing<BR>);</FONT></P>
<P><FONT color=#008000 size=2>// Insert the logo templates<BR></FONT><FONT size=2><FONT color=#008000>// Logo is within a text box shape - so select ranges in shape<BR></FONT><FONT color=#008080>Globals</FONT>.ThisDocument.CompanyLogoBookmark.Range.Select();<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Application.Selection.Start += 1;<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Application.Selection.End -= 1;<BR><FONT color=#008080>Globals</FONT>.ThisDocument.Application.Selection.InsertFile(<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string</FONT>.Format(<FONT color=#800000>"{0}\\{1}\\Logo.doc"</FONT>,<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>MySettings.TemplateDirectory,<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>TemplatePath<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>),<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing, <FONT color=#0000ff>ref</FONT> missing<BR>);</FONT><FONT size=4></P></FONT></FONT></FONT>
<P><FONT face=Verdana size=2>Of course instead of having those templates on the file-system as it is the case in my solution, it would be better retrieving them through a web service or from a database. But the concept is still the same.</FONT></P>
<P><FONT face=Verdana size=2>With this solution you can provide a "central template" with the customization and all the automatic update features of the "central template" for the VSTO customization and at the same time you have the ability to customize the "central template" with contents from plain word documents without any additional functionality.</FONT></P>
<P><FONT face=Verdana size=2>As I had to attach the image to this blog entry, please <A HREF="/mszcool/archive/2006/03/27/562076.aspx">follow-up with my next blog entry</A> to get the sample:))</FONT></P>
<p><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Components.PostAttachments/00/00/56/20/71/SolutionExplorer.JPG" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-components-postattachments/00-00-56-20-71/SolutionExplorer.JPG">SolutionExplorer.JPG</a></p></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
