<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Remote Debugging with Source Control on IIS 6.0</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/mszCool [mario]' target='_blank'>mszCool [mario]</a>
<time>    10/25/2004 3:44:00 PM</time>
<hr>
<div id='content'><p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">As last week I got a question about how we can configure remote debugging on a Windows Server 2003 running with IIS 6.0 together with source control if Visual SourceSafe cannot work together with FrontPage Server extensions I thought… just try it.</span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"></span>&nbsp;</p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"></span><span lang="EN" style="mso-ansi-language: EN-GB">Simply let’s start with the first point: how can we perform remote debugging from a Windows XP Service Pack 2 (as non-admin) on a Windows Server 2003.</span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"></span>&nbsp;</p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><strong>The Windows XP SP2 Developer Machine (client)<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></strong></span></p><span lang="EN" style="mso-ansi-language: EN-GB"><o:p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"></span>&nbsp;</p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">My client machine is a Windows XP SP2 with the Windows Firewall enabled. I am not working as administrator on this machine. For enabling remote debugging on my machine I have to perform some configurations on the firewall. More exactly for remote debugging some ports must be opened on the client developer machine. In my exception list I have configured the following ports:<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <ul style="MARGIN-TOP: 0cm" type="disc"> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><?xml:namespace prefix = st1 ns = "urn:schemas-microsoft-com:office:smarttags" /><st1:place w:st="on"><st1:PlaceName w:st="on"><span lang="EN" style="mso-ansi-language: EN-GB">Remote</span></st1:PlaceName><span lang="EN" style="mso-ansi-language: EN-GB"> <st1:PlaceName w:st="on">Debugging</st1:PlaceName><br /><st1:PlaceType w:st="on">Port</st1:PlaceType></span></st1:place><span lang="EN" style="mso-ansi-language: EN-GB"> = 135, Protocol = TCP, Scope = My Network (subnet only)<o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Remote Debugging IP Security<br />Port = 4500, Protocol = UDP, Scope = My Network (subnet only)<o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Remote Debuggin IP Security (2)<br />Port = 500, Protocol = UDP, Scope = My Network (subnet only)<o:p></o:p></span></li></ul> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">Furthermore don’t forget to add the Visual Studio .NET development environment (devenv.exe) to the exception list (but I think that’s what every developer is doing the first time when using Visual Studio .NET after installed SP2</span><span lang="EN" style="FONT-FAMILY: Wingdings; mso-ansi-language: EN-GB; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-char-type: symbol; mso-symbol-font-family: Wingdings"><span style="mso-char-type: symbol; mso-symbol-font-family: Wingdings">J</span></span><span lang="EN" style="mso-ansi-language: EN-GB">). As I have seen afterwards there is a tool available for enabling remote debugging on XP SP2 - see link list below.</span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"></span>&nbsp;</p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><strong>The Windows Server 2003 Server Machine<o:p></o:p></strong></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">First of all for simplicity I have installed a full Visual Studio .NET on the server. But in general it is sufficient to just install the Remote Debugging components either through the setup wizard or manually (see links below). <o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">I have tried very long finding a practical way for project teams of a size larger than&nbsp;2 developers for doing the whole thing not as administrator on the server. But to be honest, the way described in the corresponding <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;817265">article on MSDN</a> works for a couple of users (I am working similar on my developer machine with Windows Server 2003 as I am not developing as administrator) or for a hand full of users but not for a large project team. Therefore I decided to investigate in that more but leave the configuration so that any developer is administrator on the “development team web server” (but not on the development machine; and of course this should be an isolated web server provided to the development team, only, that has no relationship to any production environment or the outside world).<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">So currently the only way how I did it was adding me to the administrators group of the remote server. With that in place you can create an ASP.NET web project by specifying an URL like the following: <a href="http://remotecomputer/webdirectory">http://remotecomputer/webdirectory</a> and start development and debugging.<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><strong>Source Control, FrontPage Server Extensions and Remote Debugging<o:p></o:p></strong></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">Remote debugging requires FrontPage Server Extensions enabled. But when working with FrontPage Server Extensions on the server, Visual Source Safe stops working for the corresponding project or solution.<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">But there is a possibility for continue working with the Visual Source Safe add-in when using FrontPage server extensions. The only restriction that you have is that adding the project to source control must be done through FrontPage Server Extensions console (or web on IIS 6.0 and Windows Server 2003).<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">For that purpose you have to install Visual Source Safe on your server machine. Afterwards configure Visual Source Safe to automatically connect to your source control database (which might reside on the same or another machine). In any case all developer users must be configured separately in your Source Safe database (all developers with their user name only, not in the format &lt;DOMAIN&gt;\&lt;USERNAME&gt; but only in the format &lt;USERNAME&gt;) using Visual Source Safe Admin.<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">As soon as your Source Safe instance is configured properly you can configure webs using the SharePoint Administrator from the administrative tools. Open the SharePoint administrator, select the Default Web Site. Then create a sub web for your web applications. If you already have created an ASP.NET web application on the server fire up the IIS management console, right click the ASP.NET virtual directory and select “All Tasks – Configure Server Extensions 2002” for creating a sub web. As soon as you have done that you can configure Front Page Server Extensions for your sub web. When opening the SharePoint Administrator again from Administrative Tools and selecting the Default Web Site the new sub-web should appear at the bottom of the page.<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB">In the configuration for the sub web you can select the “Configure Version Control”. In that option select “Use external version control” and specify the Source Safe path in your source control database that should be the root for your project. When opening the remote project next time using Visual Studio .NET you have all the Source Control options in place – check-in, check-out as when managing the project from the local machine.<o:p></o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><strong>Interesting links for configuring remote debugging:<o:p></o:p></strong></span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN" style="mso-ansi-language: EN-GB"><o:p>&nbsp;</o:p></span></p> <ul style="MARGIN-TOP: 0cm" type="disc"> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Setup Remote Debugging – general article<br /><a href="http://support.microsoft.com/kb/318041/EN-US/">http://support.microsoft.com/kb/318041/EN-US/</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Setting up remote debugging on MSDN<br /><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vsdebug/html/vctskinstallingremotedebugmonitor.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vsdebug/html/vctskinstallingremotedebugmonitor.asp</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Minimum Permissions Required for remote debugging<br /><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;329282">http://support.microsoft.com/default.aspx?scid=kb;en-us;329282</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Remote Debugging and Windows XP SP2<br /><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;833977">http://support.microsoft.com/default.aspx?scid=kb;en-us;833977</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Debug Firewall Utility for Windows XP SP2<br /><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;841177">http://support.microsoft.com/default.aspx?scid=kb;en-us;841177</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Multi-User Debugging on IIS 6.0 (in my opinion for small teams, only)<br /><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;817265">http://support.microsoft.com/default.aspx?scid=kb;en-us;817265</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">FrontPage Server Extensions and Source Control<br /><b style="mso-bidi-font-weight: normal">Warning:</b> if you are using IIS 6.0 the configuration is not done through IIS MMC but through the “Administrative Tools – Microsoft SharePoint Administrator” web administration tool!!<br /><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sccvs70/html/veurfaddingfrontpagewebapplicationstosourcecontrol.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sccvs70/html/veurfaddingfrontpagewebapplicationstosourcecontrol.asp</a> <o:p></o:p></span> <li class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">If the external option is not available in FrontPage Server Extensions<br /><a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q296715">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q296715</a> </span></li></ul> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; tab-stops: list 36.0pt; mso-list: l0 level1 lfo1"><span lang="EN" style="mso-ansi-language: EN-GB">Hope this is useful for some of you out there...</span></p> <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"></o:p></span>&nbsp;</p></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
