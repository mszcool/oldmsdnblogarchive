<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>VSTO 2005 Event in Denmark - and a new version of my SmartDoc Framework ... and a plan to work with object binding in the future</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/mszCool [mario]' target='_blank'>mszCool [mario]</a>
<time>    2/24/2006 6:03:00 AM</time>
<hr>
<div id='content'><P><FONT face=Arial size=2>Yesterday I did a VSTO 2005 event in Denmark - Aarhus for about 150 attendees there. It was really a great run and much fun for me. Actually for two reasons:</FONT></P>
<UL>
<LI><FONT face=Arial size=2>It was the first technical workshop I did in a cinema. That was actually great fun because I was always waiting for King Kong or Darth Vader appearing behind me on the screen.</FONT> 
<LI><FONT face=Arial size=2>Already, I have been very often to Denmark - but I never left the airport (when we go to Redmond, we almost everytime go through Copenhagen). This time - thanks to Niels (DE in Denmark) - I left the airport for the first time and have seen something of the country.</FONT></LI></UL>
<P><FONT face=Arial size=2>Also, the audience motivated me, to continue my work on the VSTO 2005 Smart Documents framework I have layered on-top of the VSTO 2005 classes. So the first little changes are updated on the workspace. Two cool features: the first one is that I have added the possibility to run Web Service calls asynchronously with letting the framework automatically show some sort of "Wait Window" allowing the user to cancel the call and secondly the Excel-Controller now supports specifying NamedRange and XmlMappedRange objects to be used as "Context" objects in the framework.</FONT></P>
<P><FONT face=Arial size=2>Here is the link to the workspace: </FONT></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><A href="http://www.gotdotnet.com/Workspaces/Workspace.aspx?id=dacdee7f-6e99-4303-b743-4be141ff7710">http://www.gotdotnet.com/Workspaces/Workspace.aspx?id=dacdee7f-6e99-4303-b743-4be141ff7710</A></SPAN></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><FONT face=Arial size=2></FONT></SPAN>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p><STRONG>What's next? Object Binding Support</STRONG></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p><FONT size=2></FONT></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p>Actually during my talk in Denmark I demonstrated object Binding with <STRONG>VSTO 2005 and BindingSources</STRONG>. This provides you with optimal possibilities of defining your data structures as classes and binding those to parts of your document. Therefore you define the things that are interesting for your application&nbsp;as class and bind the parts of the class to the document, that should be modified through editing the document. Suppose to have the following class:</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p></o:p></SPAN>&nbsp;</P><FONT size=4>
<P><FONT face=Arial>[</FONT></FONT><FONT face=Arial><FONT color=#008080 size=4>Serializable</FONT><FONT size=4>]<BR></FONT></FONT><FONT color=#0000ff size=4><FONT face=Arial>public</FONT></FONT><FONT face=Arial><FONT size=4> </FONT><FONT color=#0000ff size=4>class</FONT><FONT size=4> </FONT></FONT><FONT face=Arial><FONT color=#008080 size=4>SimplePerson<BR></FONT><FONT size=4>{</FONT></FONT></P>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P><FONT face=Arial><FONT color=#0000ff size=4>private</FONT><FONT size=4> </FONT><FONT color=#0000ff size=4>string</FONT></FONT><FONT face=Arial><FONT size=4> _Firstname;<BR></FONT><FONT color=#0000ff size=4>public</FONT><FONT size=4> </FONT><FONT color=#0000ff size=4>string</FONT></FONT><FONT face=Arial><FONT size=4> Firstname<BR>{<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;get</FONT><FONT size=4> { </FONT><FONT color=#0000ff size=4>return</FONT></FONT><FONT face=Arial><FONT size=4> _Firstname; }<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;set</FONT><FONT size=4> { _Firstname = </FONT><FONT color=#0000ff size=4>value</FONT></FONT><FONT size=4><FONT face=Arial>; }<BR>}</FONT></P></BLOCKQUOTE>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
<P></FONT><FONT face=Arial><FONT color=#0000ff size=4>private</FONT><FONT size=4> </FONT><FONT color=#0000ff size=4>string</FONT></FONT><FONT face=Arial><FONT size=4> _Lastname;<BR></FONT><FONT color=#0000ff size=4>public</FONT><FONT size=4> </FONT><FONT color=#0000ff size=4>string</FONT></FONT><FONT face=Arial><FONT size=4> Lastname<BR>{<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;get</FONT><FONT size=4> { </FONT><FONT color=#0000ff size=4>return</FONT></FONT><FONT face=Arial><FONT size=4> _Lastname; }<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;set</FONT><FONT size=4> { _Lastname = </FONT><FONT color=#0000ff size=4>value</FONT></FONT><FONT size=4><FONT face=Arial>; }<BR>}</FONT></P>
<P></FONT><FONT face=Arial><FONT color=#0000ff size=4>private</FONT><FONT size=4> </FONT><FONT color=#008080 size=4>DateTime</FONT></FONT><FONT face=Arial><FONT size=4> _Birthdate;<BR></FONT><FONT color=#0000ff size=4>public</FONT><FONT size=4> </FONT><FONT color=#008080 size=4>DateTime</FONT></FONT><FONT face=Arial><FONT size=4> Birthdate<BR>{<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;get</FONT><FONT size=4> { </FONT><FONT color=#0000ff size=4>return</FONT></FONT><FONT face=Arial><FONT size=4> _Birthdate; }<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;set</FONT><FONT size=4> { _Birthdate = </FONT><FONT color=#0000ff size=4>value</FONT></FONT><FONT face=Arial size=4>; }<BR>}</FONT></P></BLOCKQUOTE>
<P dir=ltr><FONT face=Arial size=4>}</FONT>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p>Assume that this class defines exactly the information that is relevant for you in your applications (on both - the server and the client). You can now use the VSTO 2005 data binding infrastructure to bind a list of these persons (List&lt;SimplePerson&gt;) to a list object in Microsoft Excel. Just add an object data source to your project and drag &amp; drop it from the data sources window in Visual Studio 2005 to the surface of the Excel spread sheet. Afterwards you need to add the following code to bind the "object data source" to your list of persons:</o:p></SPAN></P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p><FONT size=4><FONT size=4>
<P></FONT><FONT color=#0000ff size=4>private</FONT><FONT size=4> </FONT><FONT color=#008080 size=4>List</FONT><FONT size=4>&lt;</FONT><FONT color=#008080 size=4>SimplePerson</FONT><FONT size=4>&gt; _Persons;</P></FONT></FONT><FONT color=#0000ff size=4></FONT>
<P><FONT color=#0000ff size=4>private</FONT><FONT size=4> </FONT><FONT color=#0000ff size=4>void</FONT><FONT size=4> Sheet1_Startup(</FONT><FONT color=#0000ff size=4>object</FONT><FONT size=4> sender, System.</FONT><FONT color=#008080 size=4>EventArgs</FONT><FONT size=4> e)<BR>{<BR>&nbsp;&nbsp;&nbsp;_Persons = </FONT><FONT color=#0000ff size=4>new</FONT><FONT size=4> </FONT><FONT color=#008080 size=4>List</FONT><FONT size=4>&lt;</FONT><FONT color=#008080 size=4>SimplePerson</FONT><FONT size=4>&gt;();<BR></FONT><FONT color=#0000ff size=4>&nbsp;&nbsp;&nbsp;for</FONT><FONT size=4> (</FONT><FONT color=#0000ff size=4>int</FONT><FONT size=4> i = 0; i &lt; 10; i++)<BR>&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT color=#008080 size=4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SimplePerson</FONT><FONT size=4> p = </FONT><FONT color=#0000ff size=4>new</FONT><FONT size=4> </FONT><FONT color=#008080 size=4>SimplePerson</FONT><FONT size=4>();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.Firstname = </FONT><FONT color=#800000 size=4>"Person "</FONT><FONT size=4> + i.ToString();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.Lastname = </FONT><FONT color=#800000 size=4>"Lastname "</FONT><FONT size=4> + i.ToString();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.Birthdate = </FONT><FONT color=#008080 size=4>DateTime</FONT><FONT size=4>.Now.AddDays(i);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Persons.Add(p);<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;simplePersonBindingSource.SuspendBinding();<BR>&nbsp;&nbsp;&nbsp;simplePersonBindingSource.DataSource = _Persons;<BR>&nbsp;&nbsp;&nbsp;simplePersonBindingSource.ResumeBinding();<BR>}</P></FONT></o:p></SPAN>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial color=#000000 size=2>That's it! And the list even automatically updates the List&lt;SimplePerson&gt; collection when the user adds a new person by entering data in the spread sheet.</FONT></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial size=2></FONT>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><STRONG><FONT face=Arial size=2>If you take a look at the attachments I have added the Object-Binding sample to this post. So just download it an try it out:)... The only drawback is, that for simple NamedRange bindings you have to manually call the Databindings[index].WriteValue() method... but that's what I'll fix with my framework:))</FONT></STRONG></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial size=2></FONT>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial size=2>For me that's a perfect way of decoupling your code form the actuall document. And if you know mark the <STRONG>_Persons</STRONG> member of the sample above with the <STRONG>public</STRONG> access modifier and the <STRONG>[Cached]</STRONG> attribute, you even can de-serialize the data on the server using the ServerDocument class.</FONT></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial size=2></FONT>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial size=2>Just great stuff. And I think I'll add some more "convenience support" for it to my framework.</FONT></P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial size=2></FONT>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><FONT face=Arial color=#ff0000 size=2><STRONG>Also when you go this way you are on the perfect way to stay compatible with Office 12 and VSTO v3 - which is aboslutely essential...</STRONG></FONT></P>
<p><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Components.PostAttachments/00/00/53/85/62/ObjectBinding.zip" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-components-postattachments/00-00-53-85-62/ObjectBinding.zip">ObjectBinding.zip</a></p></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
