<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>MSDN Briefing in just one hour - VSTS DbPro Edition... Demos, Extension and Download</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/mszCool [mario]' target='_blank'>mszCool [mario]</a>
<time>    9/28/2006 6:43:00 AM</time>
<hr>
<div id='content'><P><FONT face=Verdana size=2>Just one hour, then I'll start talking about Visual Studio Team Edition for Database Professionals in our first <A href="http://blogs.msdn.com/msdnat/archive/2006/09/27/773546.aspx">MSDN Briefing</A>. The software life-cycle management topic really hunts me for the next couple of years as an Architect in our group - but I actually love this topic (it was one of the first roles I have taken on, partially,&nbsp;in my first really big project with 22 members in our team about&nbsp;8 years ago).</FONT></P>
<P><FONT face=Verdana size=2>Finally, this is the only reason why I am doing this MSDN briefing today as in the future they will be driven by our new Developer Evangelist who is going to start next week...</FONT></P>
<P><FONT face=Verdana size=2>Because today, I'll talk about how&nbsp;<STRONG>Visual Studio Team Edition for Database Professionals (Data Dude)</STRONG>&nbsp;fits into software life cycle management and I'll demonstrate how it supports the database developer with his tasks. It really solves a number of very well known-issues fairly elegent:</FONT></P>
<UL>
<LI><FONT face=Verdana size=2><EM>Fine-granular version control of your schema objects</EM><BR>as it shreds the schema objects in fine-granular SQL script files when importing from a script generated with design tools or from an existing database.</FONT></LI>
<LI><FONT face=Verdana size=2><EM>Schema comparison between different version of your databases</EM><BR>which allows you understanding all changes you have made to your schema including support for generating <EM>update scripts</EM> to update existing database schemas without loosing the data stored in the database.</FONT></LI>
<LI><FONT face=Verdana size=2><EM>Simple refactoring of databases</EM><BR>currently renaming objects is supported, only. But VS really updates anything related to an object being renamed (procedures, triggers, related tables, keys, constraings... anything).</FONT></LI>
<LI><FONT face=Verdana size=2><EM>Generation of test data and unit tests for procedures, functions and triggers<BR></EM>which is in my opinion the most useful part of the whole infrastructure as it allows you to implement some sort of test-driven development even for the database developers.</FONT></LI></UL>
<P><FONT face=Verdana size=2>Based on all these features you have to understand that it targets the <STRONG>developer aspects</STRONG> of the database-related life-cycle management parts, only. Unfortunately so far there is no support for logical and physical database design as you might know from tools such as <EM>ErWin</EM> or <EM>Visio</EM> or <EM>Silverrun</EM>. But this is something going to be addressed with one of the future versions.</FONT></P>
<P><FONT face=Verdana size=2>Also the infrastructure is highly extensible. For example the data generator for generating tons of test data can be extend with custom data generation strategies as the unit testing infrastructure can be extended with custom testing strategies and test evaluation functions / conditions. Just to give you one example - a (very simple) custom XML data generator for Visual Studio Team Edition for Database Professionals as follows:</FONT></P>
<P><FONT size=2><FONT face="Courier New">namespace TestVstsGenerator<BR>{<BR>&nbsp; [Generator(typeof(DefaultGeneratorDesigner))]<BR>&nbsp; public class CustomXmlGenerator : Generator<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; public override string ToString()<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "Custom XML Generator";<BR>&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; [Output(Description="String Value with the XML", <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name="XmlContent")]<BR>&nbsp;&nbsp;&nbsp; public string XmlOutput<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Random rnd = new Random();</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Of course using XmlWriter would be better here:)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT face="Courier New">XmlDocument doc = new XmlDocument();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc.LoadXml("&lt;sample /&gt;");</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; rnd.Next(5, 10); i++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XmlNode n = doc.CreateNode(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XmlNodeType.Element, "node", string.Empty);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; n.InnerText = string.Format("Value {0}", i);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc.DocumentElement.AppendChild(n);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return doc.OuterXml;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; private int _InputCount;</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; [Input(DefaultValue=10, Visible=true, ReadOnly=false)]<BR>&nbsp;&nbsp;&nbsp; public int ElementCount<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _InputCount; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _InputCount = value; }<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp; }<BR>}</FONT></FONT></P>
<P><FONT face=Verdana size=2>All you basically need to do is creating a class library, adding a reference to Microsoft.VisualStudio.TeamSystem.Data.dll, then create a class inheriting from Generator (in the Microsoft.VisualStudio.TeamSystem.Data.DataGenerator namespace) with a number of properties: one or more properties used as input whereas one property is queried by VS for the output. This is the case when you use the DefaultGeneratorDesigner (specified in the [Generator] attribute at class-level), but you can build your own designer, as well.</FONT></P>
<P><FONT face=Verdana size=2>Next you need to strong-name the assembly, add it to the GAC and then create an XML-file called <EM>YourAssembly.Extensions.xml</EM> which you need to copy to the C:\Program Files\Microsoft Visual Studio 8\DBPro directory. Oh yes, and in CTP 5 in addition the assembly of your custom generator needs to be at the C:\Program Files\Microsoft Visual Studio 8\DBPro\Extensions directory, as well. The XML configuration file registers the assembly and each generator-type contained in the assembly looks as follows:</FONT></P>
<P><FONT face="Courier New" size=2>&lt;?xml version="1.0" encoding="utf-8" ?&gt;<BR>&lt;extensions&nbsp; assembly="TestVstsGenerator, Version=1.0.0.0, Culture=neutral, PublicKeyToken=806d263e5103e588" version="1"&gt;<BR>&nbsp; &lt;extension type="TestVstsGenerator.CustomXmlGenerator" enabled="true" /&gt;<BR>&lt;/extensions&gt;</FONT></P>
<P><FONT face=Verdana size=2>Now you are done, just restart Visual Studio, create a new test generation plan and you have you custom XML test-data generator in the list.</FONT></P>
<P><FONT face=Verdana size=2>This is something I am going to demo in about 2,5 hours:) (I'll start with a couple of other demos, before, of course). I have attached the demos for the briefing to this post.</FONT></P>
<p><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Components.PostAttachments/00/00/77/52/71/VstsDbPro_Demos.zip" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-components-postattachments/00-00-77-52-71/VstsDbPro_5F00_Demos.zip">VstsDbPro_Demos.zip</a></p></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
